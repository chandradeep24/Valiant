\documentclass[10pt]{extarticle}
\usepackage[utf8]{inputenc}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{listings}
\usepackage{afterpage}
\usepackage{amsthm}
\usepackage[margin = 0.5in]{geometry}
\usepackage{fancyhdr}
\usepackage{framed}
\usepackage{enumitem}
\usepackage{stmaryrd}
\usepackage{multirow}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\e}{\epsilon}
\renewcommand\labelitemi{-}
\newcommand*\interior[1]{\mathring{#1}}
\newcommand*\closure[1]{\overline{#1}}
\DeclareMathOperator{\im}{Im}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem*{claim}{Claim}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}


\title{\textbf{Least Upper Bound for the Subgraph Capacity of General Graphs}}
\author{Chandradeep Chowdhury \\ cchowdhu@calpoly.edu}
\date{\today}

\begin{document}
% \maketitle

\section{Results}

\begin{definition}
    (\textbf{Interference}) Given two sets $U, W$, we say $U$ $k-$\textit{interferes} with $W$ if 
    \begin{equation}
        |U \cap W| \ge  \frac{|W|}{k}
    \end{equation}
    for some $k \in (0,|W|]$
\end{definition}

\begin{corollary}
    If $|U| = |W|$, then $U$ $k$-interferes with $W$ if and only if $W$ $k$-interferes with $U$.
\end{corollary}

We restrict the upper range of $k$ to $|W|$ for convenience, as beyond that all values of $\frac{|W|}{k}$ will be less than 1.

\begin{definition} (\textbf{(r,T,k)-Subgraph capacity}) Given a vertex set $V = \{v_1,...,v_n\}$, the \textit{$(r,T,k)$-subgraph capacity} of $V$ is the maximum number of subgraphs of size $r$ subject to the constraint that for any randomly generated subgraph $U$ of size $r$, 
\begin{equation}
    \E[X] \le T
\end{equation}
where $X$ is the number of interferences caused by adding $U$ to the existing collection of subgraphs. 
\end{definition}

\begin{lemma}
    Given a vertex set $V$ with $n$ vertices and two subsets $U,W$ of size $r$, the probability that $U$ $k$-interferes with $W$ is 
    \begin{equation*}
        \sum_{y = \left\lceil \frac{r}{k} \right\rceil}^{r}  \frac{\binom{r}{y} \binom{n-r}{r-y}}{\binom{n}{r}}
    \end{equation*}
\end{lemma}
\begin{proof}
    if $V = \{v_1,...,v_n\}$, we can represent a subset $U$ as a vector of length $n$, $u$ defined by
    $$
    u_i = \begin{cases}
        1 & \text{if } v_i \in U \\
        0 & \text{if } v_i \notin U
    \end{cases}
    $$
    With this representation, $U,W$ intersect at the indices where both vectors $u, w$ have a $1$. Let $Y$ be a random variable denoting the number of indices where both $u, w$ have a 1. Then 
    \begin{equation}
        P(Y=y) = \frac{\binom{r}{y} \binom{n-r}{r-y}}{\binom{n}{r}}
    \end{equation}
    Then the probability that $U$ $k$-interferes with $W$ is 
    \begin{equation}
        \sum_{y = \left\lceil \frac{r}{k} \right\rceil}^{r}  \frac{\binom{r}{y} \binom{n-r}{r-y}}{\binom{n}{r}}
    \end{equation}
\end{proof}

\begin{theorem}
    Given a vertex set $V$ with $n$ vertices, the $(r,T,k)$-subgraph capacity of $V$ is 
    \begin{equation*}
        \left\lfloor \frac{T}{\sum_{y = \left\lceil \frac{r}{k} \right\rceil}^{r}  \frac{\binom{r}{y} \binom{n-r}{r-y}}{\binom{n}{r}}} + 1 \right\rfloor
    \end{equation*}
\end{theorem}
\begin{proof}
    Let $M-1$ be the number of subgraphs of size $r$ currently generated. Add an arbitrary subgraph $U$ of size $r$. From lemma 4., we know that the probability of $U$ $k$-interfering with another subgraph is $\sum_{y = \left\lceil \frac{r}{k} \right\rceil}^{r}  \frac{\binom{r}{y} \binom{n-r}{r-y}}{\binom{n}{r}}$. This can be interpreted as the expected number of additional $k$-interferences $U$ will cause with one subgraph. Since there are $M-1$ other subgraphs, the expected number of $k$-interferences by adding $U$ is 
    \begin{equation}
        \sum_{y = \left\lceil \frac{r}{k} \right\rceil}^{r}  \frac{\binom{r}{y} \binom{n-r}{r-y}}{\binom{n}{r}} (M-1)
    \end{equation}

    From equation (2), we have 

    \begin{equation}
        \sum_{y = \left\lceil \frac{r}{k} \right\rceil}^{r}  \frac{\binom{r}{y} \binom{n-r}{r-y}}{\binom{n}{r}} (M-1) \le T \implies M \le \frac{T}{\sum_{y = \left\lceil \frac{r}{k} \right\rceil}^{r}  \frac{\binom{r}{y} \binom{n-r}{r-y}}{\binom{n}{r}}} + 1
    \end{equation}
    The $(r,T,k)$-subgraph capacity of $V$ is the largest integer $M$ that satisfies equation (6).
\end{proof}

\begin{proof}[Alternate proof]
    Suppose we have $M$ subgraphs in the collection. Pick two subgraphs $U,W$. From lemma 4., we know that the probability of $U$ $k$-interfering with $W$ is $\sum_{y = \left\lceil \frac{r}{k} \right\rceil}^{r}  \frac{\binom{r}{y} \binom{n-r}{r-y}}{\binom{n}{r}}$. Since all subgraphs have the same size, this is the probability that $U,W$ pair will cause 2 k-interferences. So the expected number of interferences caused by one pair is
    $$
    2\sum_{y = \left\lceil \frac{r}{k} \right\rceil}^{r}  \frac{\binom{r}{y} \binom{n-r}{r-y}}{\binom{n}{r}} 
    $$
    We know that there are $\binom{M}{2} = M(M-1)/2$ such pairings so the expected number of total interferences are 
    $$
    2 \frac{M(M-1)}{2} \sum_{y = \left\lceil \frac{r}{k} \right\rceil}^{r}  \frac{\binom{r}{y} \binom{n-r}{r-y}}{\binom{n}{r}}  =  M(M-1) \sum_{y = \left\lceil \frac{r}{k} \right\rceil}^{r}  \frac{\binom{r}{y} \binom{n-r}{r-y}}{\binom{n}{r}} 
    $$
    Since there are $M$ subgraphs, the expected number of interferences due to one subgraph is
    $$
    \frac{M(M-1)}{M} \sum_{y = \left\lceil \frac{r}{k} \right\rceil}^{r}  \frac{\binom{r}{y} \binom{n-r}{r-y}}{\binom{n}{r}}  = (M-1) \sum_{y = \left\lceil \frac{r}{k} \right\rceil}^{r}  \frac{\binom{r}{y} \binom{n-r}{r-y}}{\binom{n}{r}} 
    $$
    From equation (2), we have 

    \begin{equation}
        (M-1) \sum_{y = \left\lceil \frac{r}{k} \right\rceil}^{r}  \frac{\binom{r}{y} \binom{n-r}{r-y}}{\binom{n}{r}}  \le T \implies M \le \frac{T}{\sum_{y = \left\lceil \frac{r}{k} \right\rceil}^{r}  \frac{\binom{r}{y} \binom{n-r}{r-y}}{\binom{n}{r}}} + 1
    \end{equation}
    The $(r,T,k)$-subgraph capacity of $V$ is the largest integer $M$ that satisfies equation (6).
    
\end{proof}

\end{document}